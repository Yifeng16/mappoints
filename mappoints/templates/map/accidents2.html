{% load staticfiles %}
<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta charset="utf-8">
        <meta name = "viewport" content="width=device-width, initial-scale=1">
        <title>事故地图</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <style type="text/css">
            body, html,#allmap {width: 100%;height: 100%;overflow: hidden;margin:0;font-family:"微软雅黑";}
        </style>


    </head>
    <body>
        <div class="container-fluid"  style="background:rgba(126, 107, 107, 0.246)">
            <nav class="navbar navbar-expand-lg" role="navigation" >
                <div class="navbar-header" >
                    <a class="navbar-brand" href="">
                        <img src="{% static '/images/logo.png' %}" width="50px">
                    </a>
                </div>
            </nav>
        </div>
        <div>
            {% for i in mpoints  %}
                <p>{{ i.ac }}</p>
            {% endfor %})
        </div>


 
        <div id="map1_container"><div id="allmap"></div></div>

        <h1>testing</h1>


	    
        

   


    </body>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=s9BheNdnMtS2ksHdc7DocjQGPqsCzWnK"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


    <script type="text/javascript">
        // 百度地图API功能
        var map = new BMap.Map("allmap");
        var point = new BMap.Point(116.404, 39.915);
        var points =[
    {"lat":23.851746069797695,"lng":113.5304030843708,"count":3},{"lat":24.787423909938873,"lng":112.37305441499898,"count":3},{"lat":24.71869964837423,"lng":112.28158104740628,"count":3},{"lat":24.23392856863662,"lng":113.66953254738816,"count":3},{"lat":24.791382070401006,"lng":112.38556849256271,"count":3},{"lat":24.22078918819269,"lng":113.85341302982881,"count":6},{"lat":24.623848726173147,"lng":112.4014653075063,"count":8},{"lat":24.515164969495242,"lng":112.10080575294693,"count":3},{"lat":24.66656258353847,"lng":112.30420042775025,"count":3},{"lat":24.47712053787858,"lng":112.64460435352107,"count":6},{"lat":24.486468384478975,"lng":112.65271803483375,"count":3},{"lat":24.225680391225104,"lng":113.3231689849196,"count":4},{"lat":24.225680391225104,"lng":113.3231689849196,"count":3},{"lat":24.050172378761093,"lng":113.40787302618871,"count":3},{"lat":24.225680391225104,"lng":113.3231689849196,"count":3},{"lat":24.225680391225104,"lng":113.3231689849196,"count":3},{"lat":23.86502971804792,"lng":116.90612266997107,"count":3},{"lat":23.432167863037314,"lng":112.91771607791755,"count":4},{"lat":23.547999466926136,"lng":116.37950085538243,"count":3},{"lat":22.891617275708757,"lng":115.22238507890043,"count":3},{"lat":22.78411825225219,"lng":115.47067253477434,"count":3},{"lat":22.713387029563116,"lng":114.26449946167945,"count":4},{"lat":22.713387029563116,"lng":114.26449946167945,"count":3},{"lat":22.963851620831683,"lng":115.67241760091991,"count":3},{"lat":22.77873050016389,"lng":115.3729242893998,"count":5},{"lat":22.954066413381423,"lng":115.65558300532933,"count":5},{"lat":22.77873050016389,"lng":115.3729242893998,"count":3},{"lat":23.0491174991622,"lng":114.95551769006195,"count":6},{"lat":22.77873050016389,"lng":115.3729242893998,"count":3},{"lat":22.806744795427292,"lng":115.1040557910275,"count":4},{"lat":22.705406036049713,"lng":114.29116393508943,"count":4},{"lat":22.963851620831683,"lng":115.67241760091991,"count":3},{"lat":22.77873050016389,"lng":115.3729242893998,"count":3},{"lat":22.77873050016389,"lng":115.3729242893998,"count":3},{"lat":22.72763584494924,"lng":113.91298363060139,"count":3},{"lat":23.047934503032376,"lng":116.2972230783769,"count":6},{"lat":23.047934503032376,"lng":116.2972230783769,"count":3},{"lat":23.047934503032376,"lng":116.2972230783769,"count":4},{"lat":23.047934503032376,"lng":116.2972230783769,"count":3},{"lat":22.963851620831683,"lng":115.67241760091991,"count":3},{"lat":22.967876723872532,"lng":115.78802975191435,"count":2},{"lat":22.967876723872532,"lng":115.78802975191435,"count":3},{"lat":22.846082596604628,"lng":115.4610978978892,"count":3},{"lat":22.846082596604628,"lng":115.4610978978892,"count":3},{"lat":22.967876723872532,"lng":115.78802975191435,"count":3},{"lat":21.44113004147422,"lng":110.30906806517397,"count":3},{"lat":21.44113004147422,"lng":110.30906806517397,"count":3},{"lat":23.922186423402717,"lng":115.53279250592236,"count":3},{"lat":23.88864278577446,"lng":115.70008829597539,"count":3},{"lat":22.356125409593684,"lng":113.12087871058114,"count":3},{"lat":22.56121479495314,"lng":113.91898394220249,"count":4},{"lat":22.554463154634472,"lng":114.07426133338389,"count":3},{"lat":22.72763584494924,"lng":113.91298363060139,"count":3},{"lat":22.747120180371628,"lng":114.260809276544,"count":3},{"lat":22.58193447884779,"lng":114.15639529324217,"count":5},{"lat":22.56763003789066,"lng":113.05042070092956,"count":3},{"lat":23.316744741540855,"lng":113.09009166884812,"count":3},{"lat":23.28895358314155,"lng":116.07816590835328,"count":5},{"lat":23.844640942164286,"lng":114.89334875481202,"count":5},{"lat":24.953785868240317,"lng":113.43883752548027,"count":5},{"lat":23.40800372902474,"lng":113.3948175587587,"count":3},{"lat":21.58745746439612,"lng":110.97823782176965,"count":3},{"lat":21.910011069043723,"lng":111.96114012365506,"count":3},{"lat":21.72060959941224,"lng":111.60050919754666,"count":3},{"lat":24.644305592743752,"lng":115.0886163833681,"count":3},{"lat":22.69869259444879,"lng":113.81990830221699,"count":4},{"lat":24.253997697577383,"lng":115.16515899442336,"count":3},{"lat":23.40800372902474,"lng":113.3948175587587,"count":6},{"lat":23.40800372902474,"lng":113.3948175587587,"count":3},{"lat":21.09262259385684,"lng":110.01219477306273,"count":4},{"lat":22.972106720042532,"lng":115.32142676832748,"count":3},{"lat":22.806806427720083,"lng":115.10452650311457,"count":3},{"lat":23.00304356666764,"lng":115.90241364592089,"count":3},{"lat":23.84377368763392,"lng":112.5854694470902,"count":7},{"lat":23.649613531435875,"lng":112.4689313193188,"count":3},{"lat":23.19134608756425,"lng":113.33301182565764,"count":3},{"lat":22.797333046853648,"lng":113.80509704097338,"count":7},{"lat":23.830809588547684,"lng":113.96265762921786,"count":7},{"lat":23.184683065119184,"lng":113.65705698826636,"count":3},{"lat":23.277059619677228,"lng":113.3999945760551,"count":3},{"lat":23.40800372902474,"lng":113.3948175587587,"count":7},{"lat":23.043023815368237,"lng":113.76343399075655,"count":3},{"lat":22.916095360987285,"lng":113.27944581331872,"count":3},{"lat":22.868187588245423,"lng":114.70142030480164,"count":3},{"lat":23.0491174991622,"lng":114.95551769006195,"count":4},{"lat":22.94970620040859,"lng":114.31351082613502,"count":5},{"lat":24.03908301669912,"lng":114.9652621999487,"count":2},{"lat":24.30077186659771,"lng":114.7832767549638,"count":10},{"lat":24.340566290031333,"lng":114.54297659272588,"count":3},{"lat":23.982884616799588,"lng":114.830851892401,"count":5},{"lat":24.46515835963362,"lng":114.83948389778938,"count":2},{"lat":23.93305255659844,"lng":114.8269460853825,"count":3},{"lat":23.93305255659844,"lng":114.8269460853825,"count":4},{"lat":23.7124816111502,"lng":114.6725907677912,"count":3},{"lat":23.707761843252385,"lng":114.81440595946884,"count":3},{"lat":24.54360934018957,"lng":114.67181296547412,"count":3},{"lat":23.828143023635988,"lng":114.77532697937272,"count":3},{"lat":23.982884616799588,"lng":114.830851892401,"count":5},{"lat":22.960787404435568,"lng":115.45518344992195,"count":3},{"lat":22.59280833484782,"lng":112.87765772742591,"count":3},{"lat":22.92335761589315,"lng":113.7081456375012,"count":3},{"lat":23.00053342195791,"lng":113.75344304496264,"count":5},{"lat":23.043646713430313,"lng":113.7864267481924,"count":3},{"lat":22.86950872639437,"lng":113.63298219220003,"count":4},{"lat":21.73935585734264,"lng":111.93036341872353,"count":3},{"lat":23.01830130919709,"lng":113.67928360518725,"count":3},{"lat":23.057385737138066,"lng":113.96201931039049,"count":3},{"lat":22.795308241444268,"lng":113.76998309965117,"count":3},{"lat":23.40800372902474,"lng":113.3948175587587,"count":6},{"lat":22.868973090174464,"lng":113.82876430816897,"count":3},{"lat":22.920921435513474,"lng":114.01973182730106,"count":3},{"lat":23.039399664790636,"lng":114.0498078135113,"count":4},{"lat":23.0381479213658,"lng":113.63055542345886,"count":4},{"lat":22.9789469133758,"lng":113.61251831119775,"count":3},{"lat":23.068294926254694,"lng":113.9675166059401,"count":4},{"lat":23.030051448766972,"lng":113.98801324095788,"count":3},{"lat":23.12542196008235,"lng":113.71769104801658,"count":4},{"lat":22.92335761589315,"lng":113.7081456375012,"count":4},{"lat":22.92335761589315,"lng":113.7081456375012,"count":3},{"lat":22.92335761589315,"lng":113.7081456375012,"count":3},{"lat":22.97204874031563,"lng":114.01337659788798,"count":3},{"lat":22.833055721600992,"lng":113.77176945741144,"count":4},{"lat":22.841601621999168,"lng":114.18744982902841,"count":6},{"lat":22.980038292923876,"lng":114.1422425072367,"count":3},{"lat":22.872431801820554,"lng":114.00621531624618,"count":4},{"lat":22.92069629613594,"lng":114.01910811132805,"count":3},{"lat":22.879403784550043,"lng":113.22623468824936,"count":3},{"lat":23.242645753454745,"lng":112.9881482765569,"count":3},{"lat":22.775027910337887,"lng":113.36443084777437,"count":3},{"lat":23.035094840514382,"lng":113.1340256353934,"count":3},{"lat":22.829814725653517,"lng":113.22782712071451,"count":3},{"lat":22.932764506569818,"lng":113.22283404494581,"count":4},{"lat":23.027856063340533,"lng":116.27850064345263,"count":3},{"lat":23.982884616799588,"lng":114.830851892401,"count":3},{"lat":24.651897914444515,"lng":113.64217762719441,"count":3},{"lat":23.294580845554854,"lng":112.90467719326922,"count":3},{"lat":23.294580845554854,"lng":112.90467719326922,"count":4},{"lat":23.19381133547068,"lng":113.19836615937149,"count":3},{"lat":22.46133763858776,"lng":113.54809535960439,"count":3},{"lat":22.856466364892874,"lng":111.96143088808074,"count":3},{"lat":23.03829214504443,"lng":114.37494953765568,"count":4},{"lat":23.034601207437696,"lng":116.45266586287383,"count":3},{"lat":23.034601207437696,"lng":116.45266586287383,"count":3},{"lat":24.198632243206415,"lng":114.79684341212713,"count":3},{"lat":22.735148198130982,"lng":114.17416136809835,"count":4},{"lat":22.87304207431913,"lng":114.0960754430249,"count":3},{"lat":23.632520424519534,"lng":116.55742075108823,"count":4},{"lat":24.098016189360244,"lng":116.81967242809321,"count":3},{"lat":22.88458416998368,"lng":112.91950988802031,"count":3},{"lat":22.861359631532572,"lng":112.7171470023791,"count":3},{"lat":23.0491174991622,"lng":114.95551769006195,"count":3},{"lat":22.797333046853648,"lng":113.80509704097338,"count":6},{"lat":23.770021344806526,"lng":113.51709087134478,"count":4},{"lat":21.89398479059973,"lng":110.33102648130698,"count":7},{"lat":24.154802652992196,"lng":116.09119978193635,"count":4},{"lat":22.596350045479213,"lng":114.91141511769715,"count":3},{"lat":22.748207217680942,"lng":114.49349550220738,"count":3},{"lat":22.83558989929677,"lng":114.74152860916436,"count":6},{"lat":23.172484110428517,"lng":114.57666594246567,"count":4},{"lat":22.870268044065014,"lng":114.69870674843328,"count":3},{"lat":23.198362157284073,"lng":114.50039629591241,"count":3},{"lat":22.596350045479213,"lng":114.91141511769715,"count":3},{"lat":23.172484110428517,"lng":114.57666594246567,"count":4},{"lat":23.034188915076417,"lng":114.9567180362629,"count":3},{"lat":22.808253945623072,"lng":114.72574071376383,"count":3},{"lat":23.717606151138405,"lng":114.12095085836826,"count":3},{"lat":23.613158836432877,"lng":116.32422844974478,"count":3},{"lat":23.613158836432877,"lng":116.32422844974478,"count":3},{"lat":23.236049299977594,"lng":116.08199032510534,"count":3},{"lat":23.142981793701782,"lng":116.00383456396496,"count":3},{"lat":24.282088577251443,"lng":116.05846047978832,"count":3},{"lat":23.720430031281026,"lng":115.63886320599644,"count":4},{"lat":24.65145751384849,"lng":115.84127159799819,"count":3},{"lat":24.65145751384849,"lng":115.84127159799819,"count":3},{"lat":24.72749479610582,"lng":116.39649475018395,"count":3},{"lat":24.379534562234557,"lng":116.05390487161637,"count":3},{"lat":23.40800372902474,"lng":113.3948175587587,"count":3},{"lat":24.169249848961197,"lng":116.08171441595786,"count":3},{"lat":24.127751372462587,"lng":115.79219733688574,"count":3},{"lat":24.683283405987112,"lng":116.19614150107992,"count":4},{"lat":24.146183883520518,"lng":116.07981949348522,"count":3},{"lat":23.40800372902474,"lng":113.3948175587587,"count":3},{"lat":23.959486428685558,"lng":115.10017384461491,"count":5},{"lat":23.428035393914843,"lng":112.54800793074224,"count":4},{"lat":22.57886817240041,"lng":113.1136752112753,"count":3},{"lat":22.57511678345104,"lng":113.07812534115365,"count":3},{"lat":22.489330275940812,"lng":112.80486803107814,"count":3},{"lat":22.24098520871111,"lng":112.28646122262668,"count":4},{"lat":23.171586097118865,"lng":114.09511076441602,"count":3},{"lat":22.58193447884779,"lng":114.15639529324217,"count":5},{"lat":24.780317929508865,"lng":112.39586140824525,"count":3},{"lat":24.35746573568816,"lng":114.50261294111353,"count":3},{"lat":24.206419852407755,"lng":114.73580899018756,"count":4},{"lat":22.72225544462101,"lng":112.87607835632288,"count":2},{"lat":23.284406924898533,"lng":115.62919633367434,"count":4},{"lat":23.175676934591223,"lng":115.60863078976307,"count":3},{"lat":23.467495669842307,"lng":115.60458084135576,"count":9},{"lat":20.628468910262974,"lng":110.28197399152685,"count":3},{"lat":23.717606151138405,"lng":114.12095085836826,"count":3},{"lat":23.757250850469006,"lng":114.71372147587483,"count":3},{"lat":23.2776445950251,"lng":111.78842150218934,"count":3},{"lat":23.140315506547584,"lng":112.40638605980011,"count":3},{"lat":23.144924763988584,"lng":113.25270122632845,"count":3},{"lat":22.66219232274501,"lng":113.27425867122092,"count":5},{"lat":22.537737181500315,"lng":113.49259417801107,"count":3},{"lat":22.605137527397677,"lng":113.3134776306714,"count":3},{"lat":22.325763234209585,"lng":113.35331518036367,"count":3},{"lat":22.27904617729587,"lng":113.27963522642527,"count":3},{"lat":22.68935867460836,"lng":113.4241736438318,"count":3},{"lat":23.465165729124557,"lng":113.91161259900367,"count":4},{"lat":22.84025285895725,"lng":115.05995985999883,"count":4},{"lat":22.952305876076554,"lng":115.79352553278522,"count":3},{"lat":21.061900087161746,"lng":110.1782498208509,"count":3},{"lat":22.925554972054478,"lng":114.323602867231,"count":4},{"lat":22.81875772885712,"lng":114.93708109848228,"count":3},{"lat":23.230726815678857,"lng":114.66577361531216,"count":3},{"lat":23.37305366006956,"lng":114.32053689393321,"count":3},{"lat":23.37305366006956,"lng":114.32053689393321,"count":4},{"lat":22.982057442463024,"lng":114.46135672088577,"count":4},{"lat":24.907285855813587,"lng":112.40704640867182,"count":5},{"lat":24.159670604657673,"lng":113.66967784111792,"count":10},{"lat":23.565682757565725,"lng":116.5621174462252,"count":3},{"lat":23.0081535666749,"lng":113.02689610261503,"count":3},{"lat":24.79580195871189,"lng":112.40734465598239,"count":4},{"lat":22.561244800902017,"lng":113.91898397274487,"count":4},{"lat":22.98191788365281,"lng":113.13007688379666,"count":5},{"lat":22.79156823446865,"lng":114.33770686919091,"count":4},{"lat":24.937020846031288,"lng":112.45918890578247,"count":3},{"lat":23.644319985455425,"lng":115.62269809055309,"count":3},{"lat":23.919708258367177,"lng":115.5078707263367,"count":4},{"lat":24.172723836875775,"lng":115.85260631720745,"count":8},{"lat":24.132138842475843,"lng":115.6800175377184,"count":3},{"lat":24.1573428299966,"lng":115.73284403352105,"count":3},{"lat":24.39475651634696,"lng":115.73527876663888,"count":2},{"lat":23.439131822072135,"lng":117.07040482470292,"count":1},{"lat":24.69565366080376,"lng":115.93265634975377,"count":4},{"lat":24.56332739619469,"lng":115.90558507938721,"count":3},{"lat":21.64323992992085,"lng":110.8620565826925,"count":3},{"lat":23.235971753207345,"lng":115.97155933003643,"count":4},{"lat":24.390616966567922,"lng":112.6984795581249,"count":6},{"lat":24.127664719626836,"lng":112.77815831451115,"count":3},{"lat":22.841601621999168,"lng":114.18744982902841,"count":3},{"lat":24.937020846031288,"lng":112.45918890578247,"count":5},{"lat":24.159670604657673,"lng":113.66967784111792,"count":3},{"lat":24.937020846031288,"lng":112.45918890578247,"count":3},{"lat":23.432167863037314,"lng":112.91771607791755,"count":4},{"lat":22.690747933646495,"lng":113.98868463629243,"count":4},{"lat":21.9915314225518,"lng":112.14360432325627,"count":7},{"lat":21.757547403922324,"lng":112.26222802447185,"count":4},{"lat":22.149852027059627,"lng":111.76784296147179,"count":3},{"lat":21.82798712333343,"lng":112.01764288175606,"count":3},{"lat":21.90918223920447,"lng":111.95466045377636,"count":6},{"lat":21.871339090759523,"lng":111.8959047373723,"count":3},{"lat":22.40878171590404,"lng":112.03383619141616,"count":3},{"lat":22.40878171590404,"lng":112.03383619141616,"count":4},{"lat":24.270965961186302,"lng":113.47762093521624,"count":6},{"lat":24.489276544318965,"lng":114.92206776161764,"count":4},{"lat":23.828376275249152,"lng":114.75556410724441,"count":4},{"lat":20.650263203128706,"lng":109.84786197815708,"count":3},{"lat":20.934188976287437,"lng":110.02148326820235,"count":4},{"lat":21.162531288926537,"lng":110.08416209946218,"count":3},{"lat":21.927201617949102,"lng":110.47034674710949,"count":4},{"lat":21.54256949013589,"lng":110.35322391407846,"count":3},{"lat":21.264723347216414,"lng":110.25837821238203,"count":4},{"lat":21.26409688399773,"lng":110.53944315108308,"count":3},{"lat":21.39449304118702,"lng":110.42465528086844,"count":3},{"lat":21.270307383786648,"lng":110.03989543770463,"count":3},{"lat":20.33932011493144,"lng":110.21302282019825,"count":3},{"lat":20.334418368861343,"lng":110.16340127633539,"count":4},{"lat":21.411496212076447,"lng":110.90077668434768,"count":3},{"lat":22.79156823446865,"lng":114.33770686919091,"count":3},{"lat":23.199712327726363,"lng":114.40887541065317,"count":4},
    
    
    
    
    
        ];
        map.centerAndZoom(point, 15);
        map.enableScrollWheelZoom();   //启用滚轮放大缩小，默认禁用
        map.enableContinuousZoom();    //启用地图惯性拖拽，默认禁用
        var json_data = [[116.404,39.915],[116.383752,39.91334],[116.384502,39.932241]];
        var pointArray = new Array();
        for(var i=0;i<points.length;i++){
            var marker = new BMap.Marker(new BMap.Point(points[i].lng,points[i].lat)); // 创建点
            map.addOverlay(marker);    //增加点
            pointArray[i] = new BMap.Point(points[i].lng,points[i].lat);
            marker.addEventListener("click",attribute);
        }
        //让所有点在视野范围内
        map.setViewport(pointArray);
        //获取覆盖物位置
        function attribute(e){
            var p = e.target;
            alert("marker的位置是" + p.getPosition().lng + "," + p.getPosition().lat);    
        }	
    </script>
</html>


function attribute(e){
    var p = e.target;

    var l = '{{mpoints}}';
    
    var p1=document.getElementById("p1");
    //p1.innerHTML=l[1];
    var lng1=p.getPosition().lng;
    var lat1=p.getPosition().lat;
    var a;
    for (a in l){
        console.log(a)
        console.log(l[a])
        if(a.lng==lng1){
            if(a.lat==lat1){
                alert(a.ac);
                break;
            }
        }
    }
}